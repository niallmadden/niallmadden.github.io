<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB 2022b"><title>Lab 5: Graph Matching, Part 2 (MA438)</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(192, 76, 11); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 10px 0px 20px; padding-left: 0px; font-family: Helvetica, Arial, sans-serif; font-size: 14px;  }
.S3 { margin-left: 56px; line-height: 21px; min-height: 0px; text-align: left; white-space: pre-wrap;  }
.S4 { margin-bottom: 20px; padding-bottom: 4px;  }
.S5 { margin: 0px; padding: 10px 0px 10px 5px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 700; text-align: start;  }
.S6 { margin: -1px 0px 0px; padding: 10px 0px 10px 7px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: start;  }
.S7 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F5F5F5; margin: 10px 0 10px 0; }
.S8 { border-left: 0.994318px solid rgb(191, 191, 191); border-right: 0.994318px solid rgb(191, 191, 191); border-top: 0.994318px solid rgb(191, 191, 191); border-bottom: 0px none rgb(33, 33, 33); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S9 { border-left: 0.994318px solid rgb(191, 191, 191); border-right: 0.994318px solid rgb(191, 191, 191); border-top: 0px none rgb(33, 33, 33); border-bottom: 0px none rgb(33, 33, 33); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S10 { border-left: 0.994318px solid rgb(191, 191, 191); border-right: 0.994318px solid rgb(191, 191, 191); border-top: 0px none rgb(33, 33, 33); border-bottom: 0.994318px solid rgb(191, 191, 191); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S11 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S12 { border-left: 0.994318px solid rgb(191, 191, 191); border-right: 0.994318px solid rgb(191, 191, 191); border-top: 0.994318px solid rgb(191, 191, 191); border-bottom: 0.994318px solid rgb(191, 191, 191); border-radius: 4px; padding: 6px 45px 4px 13px; line-height: 18.004px; min-height: 0px; white-space: nowrap; color: rgb(33, 33, 33); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S13 { margin: 15px 10px 5px 4px; padding: 0px; line-height: 18px; min-height: 0px; white-space: pre-wrap; color: rgb(33, 33, 33); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 17px; font-weight: 700; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0' id = 'T_29A3D41C' ><span>Lab 5: Graph Matching, Part 2 (MA438)</span></h1><div  class = 'S1'><span>This version is heavily revised from the one presented in Week 8. Main changes</span></div><ul  class = 'S2'><li  class = 'S3'><span>Includes example of making a random simple bipartite graph</span></li><li  class = 'S3'><span>Has fewer bugs</span></li><li  class = 'S3'><span>Seems to actually work</span></li><li  class = 'S3'><span>Has an exercises from Problem Set 3 at the end</span></li></ul><div  class = 'S4'><div  class = 'S5'><span style=' font-weight: bold;'>Table of Contents</span></div><div  class = 'S6'><a href = "#H_9ED998F1"><span>1. Making a "random" bipartite graph
</span></a><a href = "#H_3F635004"><span>2. The Matching Algorithm: Step 0
</span></a><a href = "#H_4F2DD356"><span>3. The Matching Algorithm: Step 1
</span></a><a href = "#H_572DEF5F"><span>4. Next step
</span></a><a href = "#H_32F8BCB3"><span>Exercise 3.8 from Problem Set 3
</span></a><span>    </span><a href = "#H_9F031361"><span>Bonus
</span></a><a href = "#H_9D36A8CC"><span>Function
</span></a><span>    </span><a href = "#H_17478D98"><span>Check if a node is in a list</span></a></div></div><h2  class = 'S7' id = 'H_9ED998F1' ><span>1. Making a "random" bipartite graph</span></h2><div  class = 'S1'><span>In Lab 4, we learned several ways to construct a graph in MATLAB. In this session, we'll start by constructing our own graph, with a known matching of maximal cardinality. </span></div><div  class = 'S1'><span>We'll start by making a graph, </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">F</span><span>, on 8 vertices, with 4 edges, and 4 components. It has to be bipartite. We'll list the nodes in each part in the vectors </span><span texencoding="P_1" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAkCAYAAAAD3IPhAAAAAXNSR0IArs4c6QAAAuBJREFUWEftlk2IjVEYx///OzM2rsbCND5u5jl3YaGUhSLKEilFxMI3Ub6VJMmUwkJKyJQFCx9TSgobC0lJbCQLJJlz3rfRuGaEzFxq7nuOznRmGtNg7r3Gnal5lm/Pef6/83ydlxhBxhHEgjGY31VjLDOjPzNKqdXOuU0AFpGs6r2Rc86S7HLOdQF4D+AtgIvGmIflTOeQekYpdQHATi/knHsFYIEx5ouITCa5xzl3KMDe11ovBdBdCtSQYESkieSOILBXa32+v5hS6jSAAwH2nDFm33DCPCU51wtYa2dGUfS6v1g2m53hnHsTYD4YY6YMC0xdXV06nU5/BlDtnGszxkwdRKhGRL739lU+n6/P5XIfiwX6a5mUUssA3AmBr2qtNwwiMk5EfpDsiZfP59O5XM43d1E2FBjfH7tD1I1a6ysDFURkNsnnoUwvjDGzi6IIzkOB8b0ww/t3d3dnWltb/Sj/YiJymeRm/zFJkvVxHF/75zAiIiR1uPFrY8zMQUAaSR4LPs3GmLUDfTKZzLSamprD1tq2KIpO/A70j5kRke0kL4bDd5Mk2V8oFArV1dUTUqnULAAbSS4JIDc6Ozu3dXR0fOsVU0rVO+e8zy4A0wEc11ofLQlGKXUTwMog9o5knXNuPAAvGJGMAbyx1jZHUdTTM/3NT2J7e3un3+QAbpQDUyUiHSQnAiiQnNTS0vK1lF4QkcUk75UMIyLzSD4J4o+01gtLAfFn/gVMX2Naa49EUXSykjCPSc4P4zonjuNnFYHJZrO11tpPYb23a63r/YNdEZiGhoYVqVTqVhC/rrVeVypI2T0jIpdIbvGBrLVboyi6XBEYv6j87gBQG/bLcmPM7f8OIyJnAawi2feb4Jz7AuAWyVNa655/lmKt7NEuVvBP/iKyn+QZAE1aa/80DGp/fbXLgQpv0xqSBwFkfJZJNiZJ8iCO45cDYw8rTLEXGYOpSM+MlanYDIyKMv0Es9FVNLsts/YAAAAASUVORK5CYII=" width="17.5" height="18" /></span><span> and </span><span texencoding="P_2" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAkCAYAAAAD3IPhAAAAAXNSR0IArs4c6QAAA7JJREFUWEftlltoXEUYx///vYSIW1p0l6bL6n6zah8qhT4IioIKihVBUBQRaq01WFG8gQ99EAURFC8vKl76YB+8BEQpqCAIokIVfREtRUsxZmaOm+jqViPZbjXZnZEJZ8M23aQnmwQqZN7OzDfz/53vNkOcQYNnEAvWYBaKxppn/v+eUUrd5r2/C8B1JNOdP/LeO5LHvffHAYwD+AnAPmPMF8upzkQ5o5R6BcD9Qch7/yOAK4wxkyIyRPJB7/3eGPZTrfUNAGb6gUoEIyKvkrwvFnhIa/1yt5hS6gUAj8awLxljHl5NmG9IXhoEnHNbrLVHusUqlcpm7/3RGOY3Y8ymVYEpFAq5XC73F4CM9/5XY0yxh1BWRE508qrZbG6s1Wq/LxXotGFSSt0I4MP44Le01nf2EBkQkX9Izp7XbDZztVotJPeSRhKYkB8PxKfu0lq/OV9BRLaR/C4O0yFjzLYlUcTGSWBCLmwO9jMzM6VqtRpK+aQhIvtJ7g6T7XZ7ZxRFb684jIgISR3/8RFjzJYeIE+QfDK2GTHG7OjYDA0NFQYHB58FcBXJcwEcds49Y639uBfsop4RkT0k98UbP2q324+0Wq1WJpNZl0qltgLYRfL6GOTdRqNxT71enwrfpVLpnGw2e8h7/4P3PiJ5McnLw5pzboe1dmQ+0KIwSqn3AdwSi/1MsuC9PxtAELQkIwBHnXMj1trZnOmMuDd9rrV+r2vuXpKvA/hFa33+UmDSIlInuQFAi2R+bGzs74S5kC6Xy69Za/f0COsoyQump6fz4+Pjx7rXF/SMiFxG8uvY+KDW+sqEIMEsUywWN0xMTNR7wHwC4FpjzFkAppPCzCWmc+4xa+3TS4BZ0FREvgdQM8ZsTxwmEfmqk3DtdvuSKIq+XS5MsVg8b2BgQDvnro6i6MtEMJVKZb1z7ljc3v/QWm8MF/ZyYUQkVOakMWZv4tIul8s3p1KpA/GGd7TWd6wAyHaSw1rr20N1J4YRkTdI3h33hGFr7f7lwJRKpa3ZbPbxdDq9c3R09N+FzjqlmpRSISThClgf95ebjDEf9AtTKpUuymQyT7Vard3VavXEYuecBCMiLwK4leTcM8F7PwngAMnntNazb5akQylVBvD81NTUcKczdzfARqMx0j1/2osyqfB8u3K5vInkQQChCv/sWg8vjQu996G85+6xsL4qMPl8fl0ulwuvw1Mu1g6Uc+4aa+1niZpevx5Zzr5V8Uy/QGswiftMvy5eiX1rYVrIi/8BYkN4NGlitOUAAAAASUVORK5CYII=" width="17.5" height="18" /></span><span>.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >clear;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >P1 = 1:4; </span><span style="color: rgb(0, 128, 19);">%[1,2,3,4, 9, 10, 12 ];</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >P2 = 5:8; </span><span style="color: rgb(0, 128, 19);">% [5,6,7,8];</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >F = graph();</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:length(P1) </span><span style="color: rgb(0, 128, 19);">% assuming P1 and P2 have same length</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   F = F.addedge(P1(i),P2(i));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >plot(F); title(</span><span style="color: rgb(167, 9, 245);">"Original graph before edges added"</span><span >)</span></span></div></div></div><div  class = 'S11'><span>Next, we'll add some more edges. We'll make sure the graph is bipartite, by only adding edges that have a node in each of </span><span texencoding="P_1" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAkCAYAAAAD3IPhAAAAAXNSR0IArs4c6QAAAuBJREFUWEftlk2IjVEYx///OzM2rsbCND5u5jl3YaGUhSLKEilFxMI3Ub6VJMmUwkJKyJQFCx9TSgobC0lJbCQLJJlz3rfRuGaEzFxq7nuOznRmGtNg7r3Gnal5lm/Pef6/83ydlxhBxhHEgjGY31VjLDOjPzNKqdXOuU0AFpGs6r2Rc86S7HLOdQF4D+AtgIvGmIflTOeQekYpdQHATi/knHsFYIEx5ouITCa5xzl3KMDe11ovBdBdCtSQYESkieSOILBXa32+v5hS6jSAAwH2nDFm33DCPCU51wtYa2dGUfS6v1g2m53hnHsTYD4YY6YMC0xdXV06nU5/BlDtnGszxkwdRKhGRL739lU+n6/P5XIfiwX6a5mUUssA3AmBr2qtNwwiMk5EfpDsiZfP59O5XM43d1E2FBjfH7tD1I1a6ysDFURkNsnnoUwvjDGzi6IIzkOB8b0ww/t3d3dnWltb/Sj/YiJymeRm/zFJkvVxHF/75zAiIiR1uPFrY8zMQUAaSR4LPs3GmLUDfTKZzLSamprD1tq2KIpO/A70j5kRke0kL4bDd5Mk2V8oFArV1dUTUqnULAAbSS4JIDc6Ozu3dXR0fOsVU0rVO+e8zy4A0wEc11ofLQlGKXUTwMog9o5knXNuPAAvGJGMAbyx1jZHUdTTM/3NT2J7e3un3+QAbpQDUyUiHSQnAiiQnNTS0vK1lF4QkcUk75UMIyLzSD4J4o+01gtLAfFn/gVMX2Naa49EUXSykjCPSc4P4zonjuNnFYHJZrO11tpPYb23a63r/YNdEZiGhoYVqVTqVhC/rrVeVypI2T0jIpdIbvGBrLVboyi6XBEYv6j87gBQG/bLcmPM7f8OIyJnAawi2feb4Jz7AuAWyVNa655/lmKt7NEuVvBP/iKyn+QZAE1aa/80DGp/fbXLgQpv0xqSBwFkfJZJNiZJ8iCO45cDYw8rTLEXGYOpSM+MlanYDIyKMv0Es9FVNLsts/YAAAAASUVORK5CYII=" width="17.5" height="18" /></span><span> and </span><span texencoding="P_2" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAkCAYAAAAD3IPhAAAAAXNSR0IArs4c6QAAA7JJREFUWEftlltoXEUYx///vYSIW1p0l6bL6n6zah8qhT4IioIKihVBUBQRaq01WFG8gQ99EAURFC8vKl76YB+8BEQpqCAIokIVfREtRUsxZmaOm+jqViPZbjXZnZEJZ8M23aQnmwQqZN7OzDfz/53vNkOcQYNnEAvWYBaKxppn/v+eUUrd5r2/C8B1JNOdP/LeO5LHvffHAYwD+AnAPmPMF8upzkQ5o5R6BcD9Qch7/yOAK4wxkyIyRPJB7/3eGPZTrfUNAGb6gUoEIyKvkrwvFnhIa/1yt5hS6gUAj8awLxljHl5NmG9IXhoEnHNbrLVHusUqlcpm7/3RGOY3Y8ymVYEpFAq5XC73F4CM9/5XY0yxh1BWRE508qrZbG6s1Wq/LxXotGFSSt0I4MP44Le01nf2EBkQkX9Izp7XbDZztVotJPeSRhKYkB8PxKfu0lq/OV9BRLaR/C4O0yFjzLYlUcTGSWBCLmwO9jMzM6VqtRpK+aQhIvtJ7g6T7XZ7ZxRFb684jIgISR3/8RFjzJYeIE+QfDK2GTHG7OjYDA0NFQYHB58FcBXJcwEcds49Y639uBfsop4RkT0k98UbP2q324+0Wq1WJpNZl0qltgLYRfL6GOTdRqNxT71enwrfpVLpnGw2e8h7/4P3PiJ5McnLw5pzboe1dmQ+0KIwSqn3AdwSi/1MsuC9PxtAELQkIwBHnXMj1trZnOmMuDd9rrV+r2vuXpKvA/hFa33+UmDSIlInuQFAi2R+bGzs74S5kC6Xy69Za/f0COsoyQump6fz4+Pjx7rXF/SMiFxG8uvY+KDW+sqEIMEsUywWN0xMTNR7wHwC4FpjzFkAppPCzCWmc+4xa+3TS4BZ0FREvgdQM8ZsTxwmEfmqk3DtdvuSKIq+XS5MsVg8b2BgQDvnro6i6MtEMJVKZb1z7ljc3v/QWm8MF/ZyYUQkVOakMWZv4tIul8s3p1KpA/GGd7TWd6wAyHaSw1rr20N1J4YRkTdI3h33hGFr7f7lwJRKpa3ZbPbxdDq9c3R09N+FzjqlmpRSISThClgf95ebjDEf9AtTKpUuymQyT7Vard3VavXEYuecBCMiLwK4leTcM8F7PwngAMnntNazb5akQylVBvD81NTUcKczdzfARqMx0j1/2osyqfB8u3K5vInkQQChCv/sWg8vjQu996G85+6xsL4qMPl8fl0ulwuvw1Mu1g6Uc+4aa+1niZpevx5Zzr5V8Uy/QGswiftMvy5eiX1rYVrIi/8BYkN4NGlitOUAAAAASUVORK5CYII=" width="17.5" height="18" /></span><span>. Note that the resulting graph will always have </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">F</span><span> as a  matching. We'll also ensure the the final graph is connected, and is not a tree</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >rng(1); </span><span style="color: rgb(0, 128, 19);">% make "random" numbers not so random</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >n = 14; </span><span style="color: rgb(0, 128, 19);">% miniumum number of edges in final graph</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >G = F;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">while </span><span >( (G.numedges &lt; n) || (max(G.conncomp) &gt; 1) </span><span style="color: rgb(14, 0, 255);">...</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >      || (~G.hascycles)) </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   s = P1(randi(length(P1))); </span><span style="color: rgb(0, 128, 19);">% randomly chosen element of P1</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   t = P2(randi(length(P2))); </span><span style="color: rgb(0, 128, 19);">% randomly chosem element of P2</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   G = simplify(G.addedge(s,t)); </span><span style="color: rgb(0, 128, 19);">% simplify removed duplicate edges</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >g = plot(G);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >highlight(g,F);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'Graph G with matching highlighted'</span><span >)</span></span></div></div></div><h2  class = 'S7' id = 'H_3F635004' ><span>2. The Matching Algorithm: Step 0</span></h2><div  class = 'S1'><span>We start with an empty matching for </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">G</span><span>, which we'll call </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">M</span><span>. That is, </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">M</span><span>will have the same nodes as </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">G</span><span>, but no edges. </span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >M = graph();</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >M = M.addnode(G.numnodes); </span><span style="color: rgb(0, 128, 19);">% M has same nodes as as G</span></span></div></div></div><div  class = 'S11'><span>We also need a list of vertices that are not yet matched. Since </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">M</span><span> is empty, that's just all the nodes in G.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S12'><span style="white-space: pre"><span >M_notmatched = 1:G.numnodes; </span><span style="color: rgb(0, 128, 19);">% M_notmatched= [1,2,3, ..., n]</span></span></div></div></div><h2  class = 'S7' id = 'H_4F2DD356' ><span>3. The Matching Algorithm: Step 1</span></h2><div  class = 'S1'><span>Next step is to make a directed graph, with edges between nodes if they are in the matching.</span></div><div  class = 'S1'><span>We start with an empty graph, </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">D</span><span>, with the same nodes as </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">G</span><span>. Then, for every edge </span><span texencoding="e=\{v_1,v_2\}" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="72.5" height="18" /></span><span> in </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">G</span><span>, where </span><span texencoding="v_1" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAkCAYAAACe0YppAAAAAXNSR0IArs4c6QAAAk1JREFUWEftlj9oFEEUxr/n3B4Y/IPFIZ67ywwEgtiopBOthBSihYLGKohYiShIQBH/BCLpDDZiYa8WdiJWFoIpRK20UJE3e3t3FkfE4kS9290nCxc4j7sk9880N+3sfL/3vnnzsYQNWrRBXIzA/835kdUjq4fmwGi4hmZtq3A7qx3P8yaUUpMAtltr77UeMsacSpJkPI7jxWKx+KuXav8B+76/Vyl1RkROENEeAH+YeRuAWpM4aa2rRDQmIrettXN9g1cE8vm8l81mmYhUHMeThULhXbO4MWYewHUReW6tPdq857rubsdxriVJ8i0Igjudiuo41Vrr90S0H8B5Zn7Yxu5PIvLYWnsr3TPG7BSRGSK6AMAHMM/MN7oGG2NS2DkAd5n5SotA1hhTiaLoQBiGX9O9XC63pVKpVNP7B/CkZ7DW+ioRLQB4xszHmsFa67MA9llrL7V2pLWeIqIX/YCniegRgM/MPNEEyGqtl+r1+lSpVFoeONjzvEOZTOYVgCozb10BaK0XRORtEARP291f3x27rjvuOM6XVFxENltrf/u+f1ApNc3MFzsNTd9g3/d3KKW+N8C7kiQZU0o9EJHjaRFDAwNIgyIiok1RFB1WSs3VarWZcrkcrhYYfXecimutf6YJlQ5YFEUnwzD8sFZKDQq8TEQOgCPM/GYtaKPY/p5TQ+S1iMwGQbC0HujAwOuFtYTLZSJaBHCfmdP4bLsG9gfSyOrTRDQLwBWRH0R0M47jl4VC4WMrfWDgbt0Zgbt1rOfvR1b3bF23B/8CSF4FNGcTSzIAAAAASUVORK5CYII=" width="15" height="18" /></span><span> is in </span><span texencoding="P_1" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAkCAYAAAAD3IPhAAAAAXNSR0IArs4c6QAAAuBJREFUWEftlk2IjVEYx///OzM2rsbCND5u5jl3YaGUhSLKEilFxMI3Ub6VJMmUwkJKyJQFCx9TSgobC0lJbCQLJJlz3rfRuGaEzFxq7nuOznRmGtNg7r3Gnal5lm/Pef6/83ydlxhBxhHEgjGY31VjLDOjPzNKqdXOuU0AFpGs6r2Rc86S7HLOdQF4D+AtgIvGmIflTOeQekYpdQHATi/knHsFYIEx5ouITCa5xzl3KMDe11ovBdBdCtSQYESkieSOILBXa32+v5hS6jSAAwH2nDFm33DCPCU51wtYa2dGUfS6v1g2m53hnHsTYD4YY6YMC0xdXV06nU5/BlDtnGszxkwdRKhGRL739lU+n6/P5XIfiwX6a5mUUssA3AmBr2qtNwwiMk5EfpDsiZfP59O5XM43d1E2FBjfH7tD1I1a6ysDFURkNsnnoUwvjDGzi6IIzkOB8b0ww/t3d3dnWltb/Sj/YiJymeRm/zFJkvVxHF/75zAiIiR1uPFrY8zMQUAaSR4LPs3GmLUDfTKZzLSamprD1tq2KIpO/A70j5kRke0kL4bDd5Mk2V8oFArV1dUTUqnULAAbSS4JIDc6Ozu3dXR0fOsVU0rVO+e8zy4A0wEc11ofLQlGKXUTwMog9o5knXNuPAAvGJGMAbyx1jZHUdTTM/3NT2J7e3un3+QAbpQDUyUiHSQnAiiQnNTS0vK1lF4QkcUk75UMIyLzSD4J4o+01gtLAfFn/gVMX2Naa49EUXSykjCPSc4P4zonjuNnFYHJZrO11tpPYb23a63r/YNdEZiGhoYVqVTqVhC/rrVeVypI2T0jIpdIbvGBrLVboyi6XBEYv6j87gBQG/bLcmPM7f8OIyJnAawi2feb4Jz7AuAWyVNa655/lmKt7NEuVvBP/iKyn+QZAE1aa/80DGp/fbXLgQpv0xqSBwFkfJZJNiZJ8iCO45cDYw8rTLEXGYOpSM+MlanYDIyKMv0Es9FVNLsts/YAAAAASUVORK5CYII=" width="17.5" height="18" /></span><span> and </span><span texencoding="v_2" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAkCAYAAACe0YppAAAAAXNSR0IArs4c6QAAAvRJREFUWEftlktoFEEQhqvsnSWR+I6QLLOzNRgJGgQVT4oPUMhB9KAgERGRoJ7Eg4iCiAaFIILiRSN4joJ4E8GLgo8goqKoBzVS3bvJghhFyIpmM9slExJYlyQ7eZnLznG6//pq/q6qaYRZenCWuFAB/zfnK1ZXrJ4xByrFNWPWlgYezWonmUw2KqXWAcACrfXVUpHv+3ustQ2FQuFKT0/P78lk+w/Y87wmpdReEdmFiCsAYICZ5wNAvig4ElEOEeeKyDmtdduUwSMBEolEMh6PMyKqQqGwLp1OvyoO7vv+BQA4LSL3tdbbw7W6urqlVVVVFwFgMyIuAYB31tp2Y8z90RIbs6qJ6DUirgGAQ8x8cxS7P4rIba31Wdd1FzuO81ZEPohIGhGbEHF9qLHW7jPGdEY546E9vu+HsFYAuMzMx0uEcd/3vwVBsDaTyXwhomuI+IiZ74zsI6IjiNgBABlm9iKDiegUIrYDwD1m3lEsJKKDALBaa30MAFQqlbpujDlcGpyIuhFxWT6fr+3t7f1evD6e1S2IeAsAPjFzY5EoTkRdg4ODzcPBYolEYmE2m+0bBfwAALZpratLCnTsG0gymdwYi8UeA0COmecVWdguIi+NMXfLVTMRvQGAr1rr5shWu67b4DjO51AgItVa6z+e521QSrUw89Fy0JHOsNZuSafTTyODPc9bpJT6MQyut9bOVUp1iMjOMIlyYCK6AQA/tdYnJ9ROABAOigAR5wRBsEkp1ZbP5w9ks9lMBGgzIrYyc0vYURMFAxH9CidUWGBBEOzOZDLvy0Fd113lOM4ZpdT+7u7ugbH2j/tbJKLviOiElcnMLyJAl8disfNBEBwsN8PLgZ+JyAljTFc5qO/7KQC41N/f39rX19df0vdHcrlcZ/H7abkIpFKpekR8AgDhTB8qyOEHEbFBRMKW2hdpgJT7wpH12traeTU1Nc8RceVYGmvtVmPMw2kFR00wch9PNmBU3bSccVRYxerJODVlzayd8V+0Wig0lw2lJAAAAABJRU5ErkJggg==" width="15" height="18" /></span><span> is in </span><span texencoding="P_2" style="vertical-align:-6px"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAkCAYAAAAD3IPhAAAAAXNSR0IArs4c6QAAA7JJREFUWEftlltoXEUYx///vYSIW1p0l6bL6n6zah8qhT4IioIKihVBUBQRaq01WFG8gQ99EAURFC8vKl76YB+8BEQpqCAIokIVfREtRUsxZmaOm+jqViPZbjXZnZEJZ8M23aQnmwQqZN7OzDfz/53vNkOcQYNnEAvWYBaKxppn/v+eUUrd5r2/C8B1JNOdP/LeO5LHvffHAYwD+AnAPmPMF8upzkQ5o5R6BcD9Qch7/yOAK4wxkyIyRPJB7/3eGPZTrfUNAGb6gUoEIyKvkrwvFnhIa/1yt5hS6gUAj8awLxljHl5NmG9IXhoEnHNbrLVHusUqlcpm7/3RGOY3Y8ymVYEpFAq5XC73F4CM9/5XY0yxh1BWRE508qrZbG6s1Wq/LxXotGFSSt0I4MP44Le01nf2EBkQkX9Izp7XbDZztVotJPeSRhKYkB8PxKfu0lq/OV9BRLaR/C4O0yFjzLYlUcTGSWBCLmwO9jMzM6VqtRpK+aQhIvtJ7g6T7XZ7ZxRFb684jIgISR3/8RFjzJYeIE+QfDK2GTHG7OjYDA0NFQYHB58FcBXJcwEcds49Y639uBfsop4RkT0k98UbP2q324+0Wq1WJpNZl0qltgLYRfL6GOTdRqNxT71enwrfpVLpnGw2e8h7/4P3PiJ5McnLw5pzboe1dmQ+0KIwSqn3AdwSi/1MsuC9PxtAELQkIwBHnXMj1trZnOmMuDd9rrV+r2vuXpKvA/hFa33+UmDSIlInuQFAi2R+bGzs74S5kC6Xy69Za/f0COsoyQump6fz4+Pjx7rXF/SMiFxG8uvY+KDW+sqEIMEsUywWN0xMTNR7wHwC4FpjzFkAppPCzCWmc+4xa+3TS4BZ0FREvgdQM8ZsTxwmEfmqk3DtdvuSKIq+XS5MsVg8b2BgQDvnro6i6MtEMJVKZb1z7ljc3v/QWm8MF/ZyYUQkVOakMWZv4tIul8s3p1KpA/GGd7TWd6wAyHaSw1rr20N1J4YRkTdI3h33hGFr7f7lwJRKpa3ZbPbxdDq9c3R09N+FzjqlmpRSISThClgf95ebjDEf9AtTKpUuymQyT7Vard3VavXEYuecBCMiLwK4leTcM8F7PwngAMnntNazb5akQylVBvD81NTUcKczdzfARqMx0j1/2osyqfB8u3K5vInkQQChCv/sWg8vjQu996G85+6xsL4qMPl8fl0ulwuvw1Mu1g6Uc+4aa+1niZpevx5Zzr5V8Uy/QGswiftMvy5eiX1rYVrIi/8BYkN4NGlitOUAAAAASUVORK5CYII=" width="17.5" height="18" /></span><span>, we'll add the directed edge </span><span texencoding="(v_1,v_2)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="43" height="18" /></span><span> to </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">D</span><span> if it is also in </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">M</span><span>. Otherwise we add the edge </span><span texencoding="(v_1,v_2)" style="vertical-align:-6px"><img src="data:image/png;base64,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" width="43" height="18" /></span><span> to </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">D</span><span>.</span></div><div  class = 'S1'><span>Some features of MATLAB's graph obect  that we'll use:</span></div><ul  class = 'S2'><li  class = 'S3'><span>If </span><span style=' font-family: monospace;'>G</span><span> is a graph, then </span><span style=' font-family: monospace;'>G.numedges</span><span> is the number of edges in </span><span style=' font-family: monospace;'>G</span><span>.</span></li><li  class = 'S3'><span style=' font-family: monospace;'>G.Edges</span><span> returns a "table" representing the edges. Since we haven't used tables, we'll access the associated </span><span texencoding="n \times 2" style="vertical-align:-5px"><img src="data:image/png;base64,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" width="34" height="18" /></span><span> matrix, where  </span><span style=' font-family: monospace;'>n=G.numedge. </span><span>Do that with the </span><span style=' font-family: monospace;'>G.Edges.endnodes </span><span>matrix. </span></li><li  class = 'S3'><span style=' font-family: monospace;'>Row </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">i</span><span> of this matrix contains the start end nodes of Edge </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">i</span><span> of </span><span style=' font-family: monospace;'>G</span><span>.</span></li></ul><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >D = digraph(); </span><span style="color: rgb(0, 128, 19);">% D1 is a *directed* graph</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >D = D.addnode(G.numnodes);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(0, 128, 19);">% Iterate over the edges of H</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >n = G.numedges;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i = 1:n</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   e = G.Edges.EndNodes(i,:); </span><span style="color: rgb(0, 128, 19);">% e is vector</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">if </span><span >( iselement(P1, e(1)))</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >      v1=e(1); v2=e(2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >      v1=e(2); v2=e(1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">if </span><span >(M.findedge(v1,v2)) </span><span style="color: rgb(0, 128, 19);">% is (e(1),e(2)) in matching?</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >      D = D.addedge(v1, v2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >      D = D.addedge(v2, v1);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >plot(D); title(</span><span style="color: rgb(167, 9, 245);">"D (step 1)"</span><span >);</span></span></div></div></div><div  class = 'S11'><span>Now we need to find a path in </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">D</span><span> between any pair of unmatched nodes, i.e., vertices in the list </span><span style=' font-family: monospace;'>M_notmatched</span><span>. There could be numerous such paths. Although it is quite inefficient, we'll check all, and choose the longest one.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span >P = [];</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >u1=M_notmatched </span><span style="color: rgb(0, 128, 19);">% iterate over all matched nodes</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">for </span><span >u2 = setdiff(M_notmatched, u1) </span><span style="color: rgb(0, 128, 19);">% iterate over those other than i</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >      p1 = D.shortestpath(u1,u2);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >      </span><span style="color: rgb(14, 0, 255);">if </span><span >(length(p1) &gt; length(P))</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >         P=p1;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >      </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   </span><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >fprintf(</span><span style="color: rgb(167, 9, 245);">"New path is : "</span><span >); disp(P)</span></span></div></div></div><div  class = 'S11'><span>Next we add every odd numbered this path to </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">M</span><span>, removing the even numbered ones. The first and last nodes in </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">P</span><span> will no longer be unmatched, so we remove them.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=1:2:length(P)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   M=M.addedge(P(i),P(i+1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">for </span><span >i=2:2:length(P)-1</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   M=M.rmedge(P(i),P(i+1));</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >M_notmatched = setdiff(M_notmatched, P(1)); </span><span style="color: rgb(0, 128, 19);">% remove the 1st</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >M_notmatched = setdiff(M_notmatched, P(end)); </span><span style="color: rgb(0, 128, 19);">% and last nodes in P</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'>&nbsp;</div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >g = plot(G);</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >highlight(g,M);</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span >title(</span><span style="color: rgb(167, 9, 245);">'Graph G with matching highlighted (step 1)'</span><span >)</span></span></div></div></div><div  class = 'S11'><span></span></div><h2  class = 'S7' id = 'H_572DEF5F' ><span>4. Next step</span></h2><div  class = 'S1'><span>If you run the code in the section above, it should add new vertices to the matching every time, until such time as all edges are matched. Then it breaks because </span><span style="font-family: STIXGeneral, STIXGeneral-webfont, serif; font-style: italic; font-weight: 400; color: rgb(33, 33, 33);">P</span><span> will be empty, and so </span><span style=' font-family: monospace;'>P(1)</span><span> is not legal.</span></div><h2  class = 'S7' id = 'H_32F8BCB3' ><span>Exercise 3.8 from Problem Set 3</span></h2><div  class = 'S1'><span style=' font-style: italic;'>This is an exercise from Problem Set 3. </span></div><div  class = 'S1'><span style=' font-style: italic;'>Rather than repeatedly running the code in Section 3 until it breaks, write a </span><span style=' font-style: italic; font-family: monospace;'>while()</span><span style=' font-style: italic;'> loop that repeats it. When doing that, it might be helpful to remove all text from that section (so that all the code is in a single cell). What is a good termination requirement?</span></div><div  class = 'S1'><span style=' font-style: italic;'>Also: change the graph generated in Section 1 so that it has at least 20 vertices.</span></div><div  class = 'S1'><span style=' font-style: italic;'>Upload your live script to Blackboard (Lab 5). Deadline: to be discussed.</span></div><h3  class = 'S13' id = 'H_9F031361' ><span style=' font-style: italic;'>Bonus</span></h3><div  class = 'S1'><span style=' font-style: italic;'>If you'd like to show off your MATLAB programming skills, </span></div><ul  class = 'S2'><li  class = 'S3'><span style=' font-style: italic;'>write a function that creates a random bipartite graph.</span></li><li  class = 'S3'><span>write a function that computes a matching for any input graph. </span></li></ul><h2  class = 'S7' id = 'H_9D36A8CC' ><span>Function</span></h2><h3  class = 'S13' id = 'H_17478D98' ><span>Check if a node is in a list</span></h3><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S8'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">function </span><span >YN = iselement(A, s) </span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">if </span><span >isempty(find(A==s,1))</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   YN = false;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">else</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span >   YN = true;</span></span></div></div><div class="inlineWrapper"><div  class = 'S9'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div><div class="inlineWrapper"><div  class = 'S10'><span style="white-space: pre"><span style="color: rgb(14, 0, 255);">end</span></span></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Lab 5: Graph Matching, Part 2 (MA438)
% This version is heavily revised from the one presented in Week 8. Main changes
%% 
% * Includes example of making a random simple bipartite graph
% * Has fewer bugs
% * Seems to actually work
% * Has an exercises from Problem Set 3 at the end
%% 1. Making a "random" bipartite graph
% In Lab 4, we learned several ways to construct a graph in MATLAB. In this 
% session, we'll start by constructing our own graph, with a known matching of 
% maximal cardinality. 
% 
% We'll start by making a graph, $F$, on 8 vertices, with 4 edges, and 4 components. 
% It has to be bipartite. We'll list the nodes in each part in the vectors $P_1$ 
% and $P_2$.

clear;
P1 = 1:4; %[1,2,3,4, 9, 10, 12 ];
P2 = 5:8; % [5,6,7,8];
F = graph();
for i=1:length(P1) % assuming P1 and P2 have same length
   F = F.addedge(P1(i),P2(i));
end
plot(F); title("Original graph before edges added")
%% 
% Next, we'll add some more edges. We'll make sure the graph is bipartite, by 
% only adding edges that have a node in each of $P_1$ and $P_2$. Note that the 
% resulting graph will always have $F$ as a  matching. We'll also ensure the the 
% final graph is connected, and is not a tree

rng(1); % make "random" numbers not so random
n = 14; % miniumum number of edges in final graph
G = F;
while ( (G.numedges < n) || (max(G.conncomp) > 1) ...
      || (~G.hascycles)) 
   s = P1(randi(length(P1))); % randomly chosen element of P1
   t = P2(randi(length(P2))); % randomly chosem element of P2
   G = simplify(G.addedge(s,t)); % simplify removed duplicate edges
end
g = plot(G);
highlight(g,F);
title('Graph G with matching highlighted')
%% 2. The Matching Algorithm: Step 0
% We start with an empty matching for $G$, which we'll call $M$. That is, $M$will 
% have the same nodes as $G$, but no edges. 

M = graph();
M = M.addnode(G.numnodes); % M has same nodes as as G
%% 
% We also need a list of vertices that are not yet matched. Since $M$ is empty, 
% that's just all the nodes in G.

M_notmatched = 1:G.numnodes; % M_notmatched= [1,2,3, ..., n]
%% 3. The Matching Algorithm: Step 1
% Next step is to make a directed graph, with edges between nodes if they are 
% in the matching.
% 
% We start with an empty graph, $D$, with the same nodes as $G$. Then, for every 
% edge $e=\{v_1,v_2\}$ in $G$, where $v_1$ is in $P_1$ and $v_2$ is in $P_2$, 
% we'll add the directed edge $(v_1,v_2)$ to $D$ if it is also in $M$. Otherwise 
% we add the edge $(v_1,v_2)$ to $D$.
% 
% Some features of MATLAB's graph obect  that we'll use:
%% 
% * If |G| is a graph, then |G.numedges| is the number of edges in |G|.
% * |G.Edges| returns a "table" representing the edges. Since we haven't used 
% tables, we'll access the associated $n \times 2$ matrix, where  |n=G.numedge.| 
% Do that with the |G.Edges.endnodes| matrix. 
% * |Row| $i$ of this matrix contains the start end nodes of Edge $i$ of |G|.

D = digraph(); % D1 is a *directed* graph
D = D.addnode(G.numnodes);
% Iterate over the edges of H
n = G.numedges;
for i = 1:n
   e = G.Edges.EndNodes(i,:); % e is vector
   if ( iselement(P1, e(1)))
      v1=e(1); v2=e(2);
   else
      v1=e(2); v2=e(1);
   end
   if (M.findedge(v1,v2)) % is (e(1),e(2)) in matching?
      D = D.addedge(v1, v2);
   else
      D = D.addedge(v2, v1);
   end
end
plot(D); title("D (step 1)");
%% 
% Now we need to find a path in $D$ between any pair of unmatched nodes, i.e., 
% vertices in the list |M_notmatched|. There could be numerous such paths. Although 
% it is quite inefficient, we'll check all, and choose the longest one.

P = [];
for u1=M_notmatched % iterate over all matched nodes
   for u2 = setdiff(M_notmatched, u1) % iterate over those other than i
      p1 = D.shortestpath(u1,u2);
      if (length(p1) > length(P))
         P=p1;
      end
   end
end
fprintf("New path is : "); disp(P)
%% 
% Next we add every odd numbered this path to $M$, removing the even numbered 
% ones. The first and last nodes in $P$ will no longer be unmatched, so we remove 
% them.

for i=1:2:length(P)-1
   M=M.addedge(P(i),P(i+1));
end
for i=2:2:length(P)-1
   M=M.rmedge(P(i),P(i+1));
end
M_notmatched = setdiff(M_notmatched, P(1)); % remove the 1st
M_notmatched = setdiff(M_notmatched, P(end)); % and last nodes in P

g = plot(G);
highlight(g,M);
title('Graph G with matching highlighted (step 1)')
%% 
% 
%% 4. Next step
% If you run the code in the section above, it should add new vertices to the 
% matching every time, until such time as all edges are matched. Then it breaks 
% because $P$ will be empty, and so |P(1)| is not legal.
%% Exercise 3.8 from Problem Set 3
% _This is an exercise from Problem Set 3._ 
% 
% _Rather than repeatedly running the code in Section 3 until it breaks, write 
% a |while()| loop that repeats it. When doing that, it might be helpful to remove 
% all text from that section (so that all the code is in a single cell). What 
% is a good termination requirement?_
% 
% _Also: change the graph generated in Section 1 so that it has at least 20 
% vertices._
% 
% _Upload your live script to Blackboard (Lab 5). Deadline: to be discussed._
% _Bonus_
% _If you'd like to show off your MATLAB programming skills,_ 
%% 
% * _write a function that creates a random bipartite graph._
% * write a function that computes a matching for any input graph. 
%% Function
% Check if a node is in a list

function YN = iselement(A, s) 
if isempty(find(A==s,1))
   YN = false;
else
   YN = true;
end
end
##### SOURCE END #####
-->
</div></body></html>